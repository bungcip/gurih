enum "PeriodStatus" {
    Open
    Closed
    Locked
}

entity "AccountingPeriod" {
    field:pk id
    field:string "name" // e.g. "Jan 2024"
    field:date "start_date"
    field:date "end_date"
    field:enum "status" "PeriodStatus" default="Open"

    options {
        track_changes #true
    }
}

page "PeriodList" {
    title "Accounting Periods"
    datatable for="AccountingPeriod" {
        column "name"
        column "start_date"
        column "end_date"
        column "status"
    }
}

page "PeriodForm" {
    title "Period"
    form for="AccountingPeriod" {
        field "name"
        group {
            field "start_date"
            field "end_date"
        }
        field "status"
    }
}

action "GenerateClosingEntry" {
    params "id"
    step "finance:generate_closing_entry" period_id="param('id')"
}

routes {
    group "/finance/periods" {
        route:post "/:id/close" action="GenerateClosingEntry"
    }
}
